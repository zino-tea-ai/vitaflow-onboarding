# NogicOS 开发规则

## 项目身份
NogicOS 是一个 AI 浏览器，核心叙事："用的人越多，所有人越快"

---

## 协作协议（最高优先级）

> 详见 `WORKFLOW.md`

### 角色定义

**你 (Zino) = Orchestration Layer**
- 定义 Mission（目标）
- 审批 Plan（计划）
- 观察 Progress（进度）
- 决定 Continue / Adjust / Stop

**我 = Model + Tools**
- Scan（扫描环境、收集上下文）
- Think（分析、规划、提出方案）
- Act（执行代码、运行测试）
- Observe（汇报结果、识别问题）

### 触发词

| 你说 | 我做 |
|------|------|
| "开始" / "继续" / "可以" | 执行计划 |
| "等一下" / "停" | 暂停讨论 |
| "review" | 生成详细报告 |
| "调整" | 修改计划 |

### 任务执行协议 (5-Step Loop)

```
1. Receive Mission → "收到，Mission: [一句话]"
2. Scan the Scene → 读文档 + 调用工具 → "环境扫描完成：[发现]"
3. Think It Through → "计划：[步骤] 风险：[如有] 需要确认？"
4. Take Action → 执行 + 汇报 → "[任务N] 完成"
5. Observe & Report → "任务报告：状态/结果/遗留/建议"
```

### 工具调用规则

| 场景 | 调用 | 方式 |
|------|------|------|
| 写代码前 | Context7 + DeepWiki | 并行 |
| 遇到 Bug | WebSearch "[错误] 2025" | 单独 |
| 技术选型 | Context7 + DeepWiki + WebSearch | 并行 |
| 简单改动 | 不需要 | 直接执行 |

---

## ⛔ 必须遵守

### 1. 开发优先级（不可改变）
1. **Python 引擎优先** - Hive Agent 是灵魂，不稳定别做别的
2. **Electron 客户端并行** - 只做最简壳子（webview + 状态显示）
3. **云端同步最后做** - 先本地，Demo 用模拟数据

### 2. 被动学习设计
- 默认开启
- 首次使用必须弹窗提示用户
- 提供设置页一键关闭
- 只学习"完成度高"的操作，不是原始点击流

### 3. 技术选型（已锁定）
- Agent 框架：LangGraph 1.0
- 浏览器控制：Playwright + CDP
- 前端：Electron 33 + React 19 + TypeScript
- LLM：Claude Opus 4.5

### 4. 代码规范
- Python 文件必须 `# -*- coding: utf-8 -*-`
- Playwright 选择器必须加 `.first` 和 `timeout=15000`
- 不用中文注释，用英文
- 改完必须跑测试

---

## 📋 开发检查清单
- [ ] 改代码前先说要改什么、为什么
- [ ] 每个模块有契约定义（Pydantic）
- [ ] 有健康检查和日志追踪
- [ ] 测试通过再说完成

---

## 🔗 关键文件

| 优先级 | 文件 | 用途 |
|--------|------|------|
| P0 | `PROGRESS.md` | 当前状态（每次必读必更新） |
| P0 | `WORKFLOW.md` | 协作协议 |
| P1 | `CHANGELOG.md` | 变更记录 |
| P1 | `ROADMAP.md` | 时间表 |
| P2 | `CLAUDE.md` | 项目全局上下文 |

---

## 📊 进度管理规则
1. **开始工作前**：读 PROGRESS.md，确认当前检查点
2. **完成子任务后**：立即更新 PROGRESS.md 状态
3. **每个检查点完成后**：运行验收测试，更新状态为 ✅
4. **遇到阻塞**：记录到风险登记表
5. **每天结束**：更新进度日志

---

## 🔄 异常处理协议

### 30 分钟规则
- **能解决** → 解决，一句话汇报
- **不能解决** → 停下来，汇报：问题/已尝试/选项A/选项B/建议

### 必须触发调整的情况
- 🔴 某个检查点延期超过 1 天
- 🔴 发现技术方案不可行
- 🔴 出现未预见的依赖
- 🔴 核心假设被推翻

### 调整原则
1. **YC 截止日期不变** - 1月10日是硬约束
2. **砍功能优先于砍质量** - 宁可少做，不做烂
3. **优先保 Demo** - 能展示 > 能用 > 完美
4. **记录经验** - 每次调整都要写 CHANGELOG

---

## 沟通
- 中文回复
- 不确定就问
- 大改动先讨论
- 如果我偏离协议，提醒我："按协议来"
