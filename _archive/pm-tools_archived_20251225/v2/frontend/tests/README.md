# PM Tool v2 - 全面测试策略

## 测试金字塔

```
                    ┌─────────────┐
                    │   E2E 测试   │  ← 用户流程、视觉回归
                   ─┴─────────────┴─
                  ┌───────────────────┐
                  │   集成测试         │  ← API + 前端交互
                 ─┴───────────────────┴─
                ┌─────────────────────────┐
                │     组件/单元测试         │  ← 组件行为、工具函数
               ─┴─────────────────────────┴─
```

## 测试类型

### 1. 🎨 视觉回归测试 (`visual-regression.spec.ts`)
- 页面截图对比
- 关键组件截图
- 响应式布局截图
- 暗色主题一致性

### 2. ♿ 可访问性测试 (`accessibility.spec.ts`)
- WCAG 2.1 AA 级别检查
- 颜色对比度
- 键盘导航
- 屏幕阅读器支持 (ARIA)

### 3. 🚀 用户流程测试 (`user-flow.spec.ts`)
- 完整用户旅程
- 页面跳转
- 数据持久化
- 错误处理

### 4. 🔧 功能测试 (`features/`)
- Onboarding 标记功能
- 截图排序功能
- 商城对比功能
- 项目管理功能

### 5. 📡 API 测试 (`api.spec.ts`)
- 后端接口响应
- 数据格式验证
- 错误处理

### 6. ⚡ 性能测试 (`performance.spec.ts`)
- 页面加载时间
- 首次内容绘制 (FCP)
- 交互响应时间

## 运行测试

```bash
# 运行所有测试
npm test

# 运行特定测试文件
npx playwright test tests/visual-regression.spec.ts

# 更新视觉快照
npx playwright test --update-snapshots

# 打开 UI 模式调试
npx playwright test --ui

# 查看测试报告
npx playwright show-report
```

## 测试覆盖目标

| 模块        | 功能测试 | 视觉测试 | 可访问性 | 性能 |
|-------------|----------|----------|----------|------|
| 首页        | ✅       | ✅       | ✅       | ✅   |
| 项目详情    | ✅       | ✅       | ✅       | ✅   |
| Onboarding  | ✅       | ✅       | ✅       | ⏳   |
| 排序        | ✅       | ✅       | ✅       | ⏳   |
| 商城对比    | ✅       | ✅       | ✅       | ⏳   |
| 分类        | ✅       | ✅       | ✅       | ⏳   |

